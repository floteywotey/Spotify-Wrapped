{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Duo Wrapped</title>
    <link rel="stylesheet" href="{% static 'SpotifyWrapped/duointermediate.css' %}">
</head>
<body>
  <!-- Deck 1 (Bottom Center) -->
  <div class="card-container" id="deck1">
    <div class="card" id="card1"></div>
    <div class="card" id="card2"></div>
    <div class="card" id="card3"></div>
    <div class="card" id="card4"></div>
    <div class="card" id="card5"></div>
    <div class="card" id="card6"></div>
    <div class="card" id="card7"></div>
    <div class="card" id="card8"></div>
  </div>

  <!-- Deck 2 (Top Center) -->
  <div class="card-container" id="deck2">
    <div class="card" id="card1"></div>
    <div class="card" id="card2"></div>
    <div class="card" id="card3"></div>
    <div class="card" id="card4"></div>
    <div class="card" id="card5"></div>
    <div class="card" id="card6"></div>
    <div class="card" id="card7"></div>
    <div class="card" id="card8"></div>
  </div>

<script>
  const fanOut = (deckId, spreadAngle, translateY) => {
    const cards = document.querySelectorAll(`#${deckId} .card`);
    const totalCards = cards.length;

    const stepAngle = spreadAngle / (totalCards - 1);
    const startAngle = -spreadAngle / 2;

    cards.forEach((card, index) => {
      const angle = startAngle + stepAngle * index;
      setTimeout(() => {
        card.style.transform = `rotate(${angle}deg) translateY(${translateY}px)`;
      }, index * 100); // Add delay for sweeping motion
    });
  };

  const combineDecks = () => {
console.log("Combining cards one by one...");
    const deck1Cards = document.querySelectorAll("#deck1 .card");
    const deck2Cards = document.querySelectorAll("#deck2 .card");

    deck1Cards.forEach((card, index) => {
        card.style.top = "50%";
        card.style.left = ""
    });
  };

  window.onload = () => {
    const deck1 = document.getElementById("deck1");
    const deck2 = document.getElementById("deck2");

    // Slide in Deck 1
    deck1.style.bottom = "10%";
    setTimeout(() => {
      // Fan out Deck 1
      fanOut("deck1", 100, -100);

      // Slide in Deck 2
      setTimeout(() => {
        deck2.style.top = "10%";
        setTimeout(() => {
          // Fan out Deck 2
          fanOut("deck2", 100, -100);

          // Combine decks after both have fanned out
          setTimeout(() => {
            combineDecks();
            setTimeout(() => {
                {#window.location.href = "{% url 'duo_wrap' %}";#}
            }, 3000);
          }, 2000); // Wait for fan-out animations to complete
        }, 2000);
      }, 1500);
    }, 2000);
  };
</script>


</body>
</html>